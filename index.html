<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mat & MÃ¥ltider â€“ IntensivtrÃ¤ning (SRS)</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f8fafc; color: #0f172a; margin:0; padding:0; }
    .wrap { max-width: 900px; margin: 0 auto; padding: 20px; }
    header { display:flex; justify-content: space-between; flex-wrap: wrap; align-items:center; gap:10px; }
    h1 { font-size: 1.5rem; margin:0; }
    .muted { font-size: 0.9rem; color:#64748b; }
    .card { background:#fff; border:1px solid #e2e8f0; border-radius:12px; margin-top:16px; }
    .card-content { padding:20px; }
    .q { font-size:1.3rem; text-align:center; min-height:100px; display:flex; align-items:center; justify-content:center; }
    .controls { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:14px; }
    button { border:none; border-radius:8px; padding:10px 14px; font-weight:bold; cursor:pointer; }
    .btn { background:#2563eb; color:white; }
    .btn.outline { background:transparent; border:1px solid #2563eb; color:#2563eb; }
    .btn.ok { background:#16a34a; color:white; }
    .btn.bad { background:#ef4444; color:white; }
    .progress { height:10px; border-radius:999px; background:#e5e7eb; overflow:hidden; }
    .bar { height:100%; width:0; background:#2563eb; transition:width 0.3s; }
    .stat { font-size:0.8rem; color:#64748b; margin-top:4px; }
    .badge { font-size:0.75rem; padding:2px 8px; border:1px solid #e2e8f0; border-radius:999px; color:#64748b; }
    .footer { text-align:center; font-size:0.8rem; color:#64748b; margin-top:20px; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Mat & MÃ¥ltider â€“ IntensivtrÃ¤ning (SRS)</h1>
        <div class="muted">InfÃ¶r prov: Again 10 min Â· Hard 30 min Â· Good 1â€“6h Â· Easy 2â€“12h</div>
      </div>
      <label><input type="checkbox" id="examToggle" checked> InfÃ¶r prov</label>
    </header>

    <div class="card"><div class="card-content">
      <div class="progress"><div id="bar" class="bar"></div></div>
      <div id="stats" class="stat">Laddarâ€¦</div>
    </div></div>

    <div id="main"></div>

    <div class="footer">
      Tangenter: Mellanslag = vÃ¤nd Â· 1â€“4 = Again/Hard/Good/Easy Â· Sparas lokalt
    </div>
  </div>

<script>
const QA = [
  {q:"Beskriv en bra frukost och fÃ¶rklara varfÃ¶r.",a:"T.ex. yoghurt med mÃ¼sli och frukt eller grovt brÃ¶d med pÃ¥lÃ¤gg. InnehÃ¥ller kolhydrater (energi), protein (bygger kroppen) och vitaminer/mineraler."},
  {q:"VarfÃ¶r Ã¤r det viktigt att Ã¤ta regelbundet?",a:"Ger jÃ¤mn energi, bÃ¤ttre koncentration och minskar risken att smÃ¥Ã¤ta onyttigt."},
  {q:"Vilka tre delar bestÃ¥r tallriksmodellen av?",a:"Kolhydrater, grÃ¶nsaker/frukt och protein."},
  {q:"Vad ger kolhydrater kroppen?",a:"Energi."},
  {q:"Vad har protein fÃ¶r funktion i kroppen?",a:"Bygger upp och reparerar kroppen."},
  {q:"VarfÃ¶r behÃ¶ver vi fett?",a:"Ger energi, bygger celler, skyddar organ."},
  {q:"Vad gÃ¶r vitaminer och mineraler i kroppen?",a:"StÃ¤rker immunfÃ¶rsvaret, behÃ¶vs fÃ¶r blod, skelett och andra funktioner."},
  {q:"Vad gÃ¶r fibrer?",a:"Bra fÃ¶r magen, hÃ¥ller blodsockret jÃ¤mnt."},
  {q:"Vad Ã¤r skillnaden pÃ¥ mÃ¤ttat och omÃ¤ttat fett?",a:"MÃ¤ttat fett (smÃ¶r, bacon, ost) Ã¤r mindre nyttigt, omÃ¤ttat fett (olja, avokado, fisk, nÃ¶tter) Ã¤r bra fÃ¶r hjÃ¤rtat."},
  {q:"Vad hjÃ¤lper matcirkeln oss med?",a:"Att planera mÃ¥ltider och fÃ¥ i oss alla nÃ¤ringsÃ¤mnen."},
  {q:"Ge exempel pÃ¥ snabba kolhydrater.",a:"Vitt brÃ¶d, godis, lÃ¤sk."},
  {q:"Ge exempel pÃ¥ lÃ¥ngsamma kolhydrater.",a:"Grovt brÃ¶d, fullkornspasta, baljvÃ¤xter."},
  {q:"VarfÃ¶r Ã¤r det bÃ¤ttre att Ã¤ta mer frÃ¥n vÃ¤xtriket Ã¤n djurriket?",a:"VÃ¤xtriket (bÃ¶nor, linser) Ã¤r nyttigt och klimatsmart, djurriket (kÃ¶tt, ost) har ofta mer mÃ¤ttat fett och stÃ¶rre klimatpÃ¥verkan."},
  {q:"VarfÃ¶r Ã¤r det bra att Ã¤ta nÃ¤rodlade och sÃ¤songsanpassade rÃ¥varor?",a:"Mindre transporter, bÃ¤ttre fÃ¶r miljÃ¶n, billigare, fÃ¤rskare och godare."},
  {q:"NÃ¤mn 5 klimatsmarta mattips.",a:"Ã„t mer vegetariskt, vÃ¤lj sÃ¤songsanpassat, vÃ¤lj nÃ¤rodlat, ta hand om rester, drick vatten istÃ¤llet fÃ¶r lÃ¤sk."},
  {q:"Vilka Ã¤r bra mÃ¥ltidsvanor?",a:"Ã„t frukost, lunch, middag och mellanmÃ¥l, drick vatten, Ã¤t varierat och lagom stora portioner, ha trevliga mÃ¥ltider."},
  {q:"VarfÃ¶r Ã¤r bra mat viktigt fÃ¶r hÃ¤lsan?",a:"Ger energi, koncentration, ork och minskar risken fÃ¶r sjukdomar."}
].map((x,i)=>({...x,id:"q"+(i+1)}));

const STORAGE="emma-srs-exam";
const now=()=>Date.now();
const dms=24*60*60*1000;
function defState(id){return {id,ease:2.5,reps:0,due:now(),lapses:0};}
let deck=QA.map(q=>({...q,state:defState(q.id)}));
const saved=localStorage.getItem(STORAGE);
if(saved){try{const p=JSON.parse(saved);const map=new Map(p.map(x=>[x.id,x]));deck=deck.map(b=>map.get(b.id)||b);}catch{}}
function save(){localStorage.setItem(STORAGE,JSON.stringify(deck));}

function gradeCard(s,g,exam){
  s={...s};
  const m=(min)=>min*60000,h=(hr)=>hr*3600000;
  if(exam){
    if(g===1){s.reps=0;s.lapses++;s.due=now()+m(10);return s;}
    if(g===2){s.reps++;s.due=now()+m(30);return s;}
    if(g===3){s.reps++;s.due=now()+[h(1),h(3),h(6)][Math.min(s.reps-1,2)];return s;}
    if(g===4){s.reps++;s.due=now()+[h(2),h(6),h(12)][Math.min(s.reps-1,2)];return s;}
  }else{
    if(g===1){s.reps=0;s.lapses++;s.due=now()+m(30);return s;}
    s.reps++;s.due=now()+dms*Math.max(1,s.reps);return s;
  }
  return s;
}
function pool(){return deck.filter(d=>d.state.due<=now()).concat(deck.filter(d=>d.state.reps===0).slice(0,10));}
function stats(){
  const poolNow=pool();
  document.getElementById('bar').style.width=(100*(deck.length-poolNow.length)/deck.length)+'%';
  document.getElementById('stats').textContent=`Klar nu: ${deck.length-poolNow.length}/${deck.length} Â· FÃ¶rfallna: ${poolNow.length}`;
}
let examMode=true;document.getElementById('examToggle').onchange=(e)=>{examMode=e.target.checked;render();};
function render(){
  stats();
  const c=pool()[0];const el=document.getElementById('main');
  if(!c){el.innerHTML='<div class="card"><div class="card-content center"><h3>Inga fler kort ðŸŽ‰</h3><p class="muted">Bra jobbat!</p><div class="controls"><button class="btn" onclick="location.reload()">Uppdatera</button><button class="btn outline" onclick="resetAll()">BÃ¶rja om</button></div></div></div>';return;}
  el.innerHTML=`<div class="card"><div class="card-content"><div class="row" style="display:flex;justify-content:space-between"><span class="badge">FÃ¶rfaller: ${Math.round((c.state.due-now())/60000)} min</span><span class="muted">Rep ${c.state.reps} Â· Lapses ${c.state.lapses}</span></div><div class="q" id="qa">${c.q}</div><div class="controls"><button class="btn outline" onclick="flip()">VÃ¤nd</button></div><div class="controls"><button class="btn bad" onclick="grade(1)">1 Again</button><button class="btn outline" onclick="grade(2)">2 Hard</button><button class="btn" onclick="grade(3)">3 Good</button><button class="btn ok" onclick="grade(4)">4 Easy</button></div></div></div>`;
  window._cid=c.id;window._showA=false;
}
function flip(){const c=deck.find(x=>x.id===window._cid);if(!c)return;const el=document.getElementById('qa');if(window._showA){el.textContent=c.q;window._showA=false;}else{el.textContent=c.a;window._showA=true;}}
function grade(g){const i=deck.findIndex(x=>x.id===window._cid);if(i<0)return;deck[i]={...deck[i],state:gradeCard(deck[i].state,g,examMode)};save();render();}
function resetAll(){if(confirm('NollstÃ¤ll?')){deck=QA.map(q=>({...q,state:defState(q.id)}));save();render();}}
window.onkeydown=(e)=>{if(e.code==='Space'){e.preventDefault();flip();}if(e.key==='1')grade(1);if(e.key==='2')grade(2);if(e.key==='3')grade(3);if(e.key==='4')grade(4);};
render();
</script>
</body>
</html>